<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Geoffrey Thompson" />

<meta name="date" content="2024-09-30" />

<title>Some Distributions Related to the Wishart</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">

div.csl-bib-body { }
div.csl-entry {
clear: both;
}
.hanging div.csl-entry {
margin-left:2em;
text-indent:-2em;
}
div.csl-left-margin {
min-width:2em;
float:left;
}
div.csl-right-inline {
margin-left:2em;
padding-left:1em;
}
div.csl-indent {
margin-left: 2em;
}
</style>

<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Some Distributions Related to the
Wishart</h1>
<h4 class="author">Geoffrey Thompson</h4>
<h4 class="date">2024-09-30</h4>



<p>The <code>stats</code> implementation of <code>rWishart</code> is in
<code>C</code> and is very fast. It is often the case that we do not
want a sample from the Wishart distribution, but rather from the inverse
of it or from the Cholesky decomposition of a sample from the Wishart
distribution. Or even from the inverse of the Cholesky decomposition of
a draw from the Wishart distribution. Funnily enough (if you have a
weird sense of humor), when you inspect the <a href="https://github.com/SurajGupta/r-source/blob/master/src/library/stats/src/rWishart.c">source
code</a> for the <code>rWishart</code> distribution (<span class="citation">R Core Team (2017)</span>), it generates the Cholesky
decomposition and then multiplies it out. Meanwhile, drawing from the
<code>rWishart</code> and then inverting or doing a Cholesky
decomposition or whatever in R is just slow – comparatively.</p>
<p>This suggests some obvious efficiencies: perhaps, if we would rather
have the Cholesky decomposition of the Wishart random matrix, we could
tell the function to stop right there.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&#39;CholWishart&#39;</span>)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">20180220</span>)</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>A <span class="ot">&lt;-</span> stats<span class="sc">::</span><span class="fu">rWishart</span>(<span class="dv">1</span>,<span class="dv">10</span>,<span class="dv">5</span><span class="sc">*</span><span class="fu">diag</span>(<span class="dv">4</span>))[,,<span class="dv">1</span>]</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">20180220</span>)</span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="fu">rInvWishart</span>(<span class="dv">1</span>,<span class="dv">10</span>,.<span class="dv">2</span><span class="sc">*</span><span class="fu">diag</span>(<span class="dv">4</span>))[,,<span class="dv">1</span>]</span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">20180220</span>)</span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a>C <span class="ot">&lt;-</span> <span class="fu">rCholWishart</span>(<span class="dv">1</span>,<span class="dv">10</span>,<span class="dv">5</span><span class="sc">*</span><span class="fu">diag</span>(<span class="dv">4</span>))[,,<span class="dv">1</span>]</span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">20180220</span>)</span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a>D <span class="ot">&lt;-</span> <span class="fu">rInvCholWishart</span>(<span class="dv">1</span>,<span class="dv">10</span>,.<span class="dv">2</span><span class="sc">*</span><span class="fu">diag</span>(<span class="dv">4</span>))[,,<span class="dv">1</span>]</span></code></pre></div>
<div id="how-the-wishart-distribution-works" class="section level2">
<h2>How the Wishart distribution works</h2>
<p>Suppose <span class="math inline">\(X_i \sim MVN(0, \Sigma)\)</span>
are independent <span class="math inline">\(p\)</span>-variate normal
random variables, <span class="math inline">\(i = 1, 2, \ldots
n\)</span> with <span class="math inline">\(n &gt; p-1\)</span>. Then
<span class="math inline">\(S = \sum X_i^T X_i\)</span>, called the
“scatter matrix”, is almost surely positive definite if <span class="math inline">\(\Sigma\)</span> is positive definite. The random
variable <span class="math inline">\(S\)</span> is said to be
distributed as a Wishart random variable: <span class="math inline">\(S
\sim W_p(n, \Sigma)\)</span>, see <span class="citation">Gupta and Nagar
(1999)</span>. This can be extended to the non-integer case as well.</p>
<p>How does <code>rWishart(n, df, Sigma)</code> work (supposing
<code>Sigma</code> is a <span class="math inline">\(p \times p\)</span>
matrix)? First, it generates a sample from the Cholesky decomposition of
a Wishart distribution with <span class="math inline">\(\Sigma =
\mathbf{I}_p\)</span>. How this is done: on the <span class="math inline">\(i^{th}\)</span> element of the main diagonal, draw
from <span class="math inline">\(\sqrt{\chi_{p-i+1}^2}\)</span>. On the
upper triangle of the matrix, sample from an independent <span class="math inline">\(N(0,1)\)</span> for each entry in the matrix.
Then, this can be multiplied by the Cholesky decomposition of the
provided <code>Sigma</code> to obtain the Cholesky factor of the desired
sample from the Wishart random variable (this construction is due to
Bartlett and is also known as the Bartlett Decomposition) (see <span class="citation">Anderson (1984)</span>). The <code>rWishart</code>
function multiplies this out. Therefore, if the Cholesky decomposition
is desired, one only needs to stop there.</p>
</div>
<div id="the-inverse-wishart-distribution" class="section level2">
<h2>The Inverse Wishart distribution</h2>
<p>If <span class="math inline">\(X \sim
\textrm{W}_p(\nu,\Sigma)\)</span>, then we define the Inverse Wishart as
<span class="math inline">\(X^{-1} = Y \sim \textrm{IW}_p(\nu ,
\Sigma^{-1})\)</span>. There are other parameterizations of the
distribution, mostly coming down to different ways of writing the <span class="math inline">\(\nu\)</span> parameter - be aware of this when
using any package drawing from the Inverse Wishart distribution (see
<span class="citation">Dawid (1981)</span> for an alternative; this
presentation follows <span class="citation">Gupta and Nagar
(1999)</span>). This comes up directly in Bayesian statistics. We are
also interested in the Cholesky decomposition of this, as it is required
in the generation of the matrix variate <span class="math inline">\(t\)</span>-distribution. In this package it is
done by taking the covariance matrix, inverting it, computing the
Cholesky decomposition of the inverted covariance matrix, drawing the
Cholesky factor of a Wishart matrix using that, and then inverting based
on that (as finding <span class="math inline">\(\Psi^{-1}\)</span> given
the Cholesky factorization of <span class="math inline">\(\Psi\)</span>
is relatively fast). This can then be converted into the Cholesky factor
of the Inverse Wishart if that is what is desired. This would be slow to
do in R, but in C it is not so bad.</p>
<p>Here is what happens with the results of the above:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a>A <span class="sc">%*%</span> B </span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a><span class="do">##               [,1]          [,2]          [,3]          [,4]</span></span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a><span class="do">## [1,]  1.000000e+00 -2.775558e-17 -1.387779e-16 -5.551115e-17</span></span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a><span class="do">## [2,] -4.718448e-16  1.000000e+00  1.387779e-17  0.000000e+00</span></span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a><span class="do">## [3,] -1.249001e-16  1.387779e-17  1.000000e+00 -5.551115e-17</span></span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a><span class="do">## [4,]  1.110223e-16 -1.110223e-16  0.000000e+00  1.000000e+00</span></span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a><span class="fu">crossprod</span>(C) <span class="sc">%*%</span> <span class="fu">crossprod</span>(D) <span class="co"># note: we do not expect C = D^-1, we expect this! </span></span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a><span class="do">##               [,1]          [,2]          [,3]          [,4]</span></span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a><span class="do">## [1,]  1.000000e+00 -2.775558e-17 -2.081668e-16 -1.110223e-16</span></span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a><span class="do">## [2,] -4.718448e-16  1.000000e+00  1.387779e-16  0.000000e+00</span></span>
<span id="cb2-11"><a href="#cb2-11" tabindex="-1"></a><span class="do">## [3,] -1.249001e-16  1.110223e-16  1.000000e+00 -1.110223e-16</span></span>
<span id="cb2-12"><a href="#cb2-12" tabindex="-1"></a><span class="do">## [4,]  1.110223e-16 -8.326673e-17 -8.326673e-17  1.000000e+00</span></span>
<span id="cb2-13"><a href="#cb2-13" tabindex="-1"></a><span class="fu">crossprod</span>(D) <span class="sc">%*%</span> A</span>
<span id="cb2-14"><a href="#cb2-14" tabindex="-1"></a><span class="do">##               [,1]          [,2]          [,3]          [,4]</span></span>
<span id="cb2-15"><a href="#cb2-15" tabindex="-1"></a><span class="do">## [1,]  1.000000e+00 -4.718448e-16 -1.249001e-16  1.110223e-16</span></span>
<span id="cb2-16"><a href="#cb2-16" tabindex="-1"></a><span class="do">## [2,] -2.775558e-17  1.000000e+00  1.110223e-16 -8.326673e-17</span></span>
<span id="cb2-17"><a href="#cb2-17" tabindex="-1"></a><span class="do">## [3,] -2.081668e-16  1.387779e-16  1.000000e+00 -8.326673e-17</span></span>
<span id="cb2-18"><a href="#cb2-18" tabindex="-1"></a><span class="do">## [4,] -1.110223e-16  0.000000e+00 -1.110223e-16  1.000000e+00</span></span>
<span id="cb2-19"><a href="#cb2-19" tabindex="-1"></a><span class="fu">crossprod</span>(C) <span class="sc">%*%</span> B</span>
<span id="cb2-20"><a href="#cb2-20" tabindex="-1"></a><span class="do">##               [,1]          [,2]          [,3]          [,4]</span></span>
<span id="cb2-21"><a href="#cb2-21" tabindex="-1"></a><span class="do">## [1,]  1.000000e+00 -2.775558e-17 -1.387779e-16 -5.551115e-17</span></span>
<span id="cb2-22"><a href="#cb2-22" tabindex="-1"></a><span class="do">## [2,] -4.718448e-16  1.000000e+00  1.387779e-17  0.000000e+00</span></span>
<span id="cb2-23"><a href="#cb2-23" tabindex="-1"></a><span class="do">## [3,] -1.249001e-16  1.387779e-17  1.000000e+00 -5.551115e-17</span></span>
<span id="cb2-24"><a href="#cb2-24" tabindex="-1"></a><span class="do">## [4,]  1.110223e-16 -1.110223e-16  0.000000e+00  1.000000e+00</span></span></code></pre></div>
<p>There is some roundoff error.</p>
</div>
<div id="the-pseudo-wishart-and-generalized-inverse-wishart" class="section level2">
<h2>The Pseudo-Wishart and Generalized Inverse Wishart</h2>
<p>Suppose, instead of the above definition of the Wishart, we have
<span class="math inline">\(n \leq p-1\)</span>. Then the scatter matrix
defined above will not be positive definite. This is called the pseudo
Wishart distribution. If we then take the Moore-Penrose pseudo-inverse
of this, we have the generalized inverse Wishart distribution.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="fu">rPseudoWishart</span>(<span class="at">n =</span> <span class="dv">1</span>, <span class="at">df =</span> <span class="dv">3</span>, <span class="at">Sigma =</span> <span class="fu">diag</span>(<span class="dv">5</span>))[, , <span class="dv">1</span>]</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>A</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a><span class="do">##            [,1]       [,2]       [,3]       [,4]       [,5]</span></span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a><span class="do">## [1,]  1.9553698  0.3134085 -0.8487259 -0.5174803  0.7487007</span></span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a><span class="do">## [2,]  0.3134085  2.3856728 -0.6106572  1.4471373  1.5976931</span></span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a><span class="do">## [3,] -0.8487259 -0.6106572  0.5838199 -0.7509533 -0.7863404</span></span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a><span class="do">## [4,] -0.5174803  1.4471373 -0.7509533  4.8520003  1.6696925</span></span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a><span class="do">## [5,]  0.7487007  1.5976931 -0.7863404  1.6696925  1.4396817</span></span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a><span class="fu">qr</span>(A)<span class="sc">$</span>rank</span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a><span class="do">## [1] 3</span></span>
<span id="cb3-11"><a href="#cb3-11" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="fu">rGenInvWishart</span>(<span class="at">n =</span> <span class="dv">1</span>, <span class="at">df =</span> <span class="dv">3</span>, <span class="at">Sigma =</span> <span class="fu">diag</span>(<span class="dv">5</span>))[, , <span class="dv">1</span>]</span>
<span id="cb3-12"><a href="#cb3-12" tabindex="-1"></a>B</span>
<span id="cb3-13"><a href="#cb3-13" tabindex="-1"></a><span class="do">##             [,1]         [,2]        [,3]         [,4]        [,5]</span></span>
<span id="cb3-14"><a href="#cb3-14" tabindex="-1"></a><span class="do">## [1,]  0.33422500  0.189387794  0.07086651 -0.052283855 -0.04241885</span></span>
<span id="cb3-15"><a href="#cb3-15" tabindex="-1"></a><span class="do">## [2,]  0.18938779  0.155647000 -0.02450637  0.001357582 -0.07549583</span></span>
<span id="cb3-16"><a href="#cb3-16" tabindex="-1"></a><span class="do">## [3,]  0.07086651 -0.024506366  0.10489215 -0.052325490  0.03515182</span></span>
<span id="cb3-17"><a href="#cb3-17" tabindex="-1"></a><span class="do">## [4,] -0.05228386  0.001357582 -0.05232549  0.028056042 -0.02793470</span></span>
<span id="cb3-18"><a href="#cb3-18" tabindex="-1"></a><span class="do">## [5,] -0.04241885 -0.075495830  0.03515182 -0.027934699  0.24217199</span></span>
<span id="cb3-19"><a href="#cb3-19" tabindex="-1"></a><span class="fu">qr</span>(B)<span class="sc">$</span>rank</span>
<span id="cb3-20"><a href="#cb3-20" tabindex="-1"></a><span class="do">## [1] 3</span></span></code></pre></div>
<p>Note that the rank of both of these matrices is less than the
dimension.</p>
</div>
<div id="density-computation" class="section level2">
<h2>Density computation</h2>
<p>This package also has functions for density computations with the
Wishart distribution. Densities are only defined for positive-definite
input matrices and <span class="math inline">\(\nu\)</span> parameters
larger than the dimension <span class="math inline">\(p\)</span>.</p>
<p>The return value is on the <code>log</code> scale but it can be
specified otherwise.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="fu">dWishart</span>(<span class="fu">diag</span>(<span class="dv">3</span>), <span class="at">df =</span> <span class="dv">5</span>, <span class="dv">5</span><span class="sc">*</span><span class="fu">diag</span>(<span class="dv">3</span>))</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a><span class="do">## [1] -19.45038</span></span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a><span class="fu">dInvWishart</span>(<span class="fu">diag</span>(<span class="dv">3</span>), <span class="at">df =</span> <span class="dv">5</span>, .<span class="dv">2</span><span class="sc">*</span><span class="fu">diag</span>(<span class="dv">3</span>))</span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a><span class="do">## [1] -19.45038</span></span></code></pre></div>
<p>Note that, in general, these will not agree even if their covariance
matrix parameters are inverses of each other. One of the reasons this
works is that the determinant of <span class="math inline">\(\mathbf{X}\)</span> is <span class="math inline">\(1\)</span>.</p>
<p>The density functions can take 3-D array input indexed on the third
dimension and will output a vector of densities.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">20180311</span>)</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="fu">rWishart</span>(<span class="at">n =</span> <span class="dv">3</span>, <span class="at">df =</span> <span class="dv">3</span>, <span class="at">Sigma =</span> <span class="fu">diag</span>(<span class="dv">3</span>))</span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a><span class="fu">dWishart</span>(A, <span class="at">df =</span> <span class="dv">3</span>, <span class="at">Sigma =</span> <span class="fu">diag</span>(<span class="dv">3</span>))</span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a><span class="do">## [1] -13.070275  -8.879220  -8.555529</span></span></code></pre></div>
</div>
<div id="other-functions" class="section level2">
<h2>Other functions</h2>
<p>The multivariate gamma (<span class="math inline">\(\Gamma_p\)</span>) and digamma (<span class="math inline">\(\psi_p\)</span>) functions are extensions of the
univariate gamma (<span class="math inline">\(\Gamma\)</span>) and
digamma (<span class="math inline">\(\psi\)</span>) functions (<span class="citation">Mardia, Bibby, and Kent (1982)</span>). They are useful
in calculating the densities above. They come up in other distributions
as well. The digamma is the first derivative of the gamma function. When
the dimension <span class="math inline">\(p = 1\)</span>, they coincide
with the usual definitions of the digamma and gamma functions.</p>
<p>The multivariate gamma also comes in a logarithmic form
(<code>lmvgamma</code>).</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="fu">lmvgamma</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>,<span class="dv">1</span>) <span class="co"># note how they agree when p = 1</span></span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a><span class="do">## [1] 0.0000000 0.0000000 0.6931472 1.7917595</span></span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a><span class="fu">lgamma</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)</span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a><span class="do">## [1] 0.0000000 0.0000000 0.6931472 1.7917595</span></span></code></pre></div>
</div>
<div id="references" class="section level1 unnumbered">
<h1 class="unnumbered">References</h1>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-Anderson84a" class="csl-entry">
Anderson, T. W., ed. 1984. <em>An Introduction to Multivariate
Statistical Analysis</em>. Wiley.
</div>
<div id="ref-dawid" class="csl-entry">
Dawid, A. P. 1981. <span>“Some Matrix-Variate Distribution Theory:
Notational Considerations and a Bayesian Application.”</span>
<em>Biometrika</em> 68 (1): 265–74. <a href="http://www.jstor.org/stable/2335827">http://www.jstor.org/stable/2335827</a>.
</div>
<div id="ref-gupta1999matrix" class="csl-entry">
Gupta, A. K., and D. K. Nagar. 1999. <em>Matrix Variate
Distributions</em>. Monographs and Surveys in Pure and Applied
Mathematics. Taylor &amp; Francis. <a href="https://books.google.com/books?id=PQOYnT7P1loC">https://books.google.com/books?id=PQOYnT7P1loC</a>.
</div>
<div id="ref-mardia1982multivariate" class="csl-entry">
Mardia, K. V., J. M. Bibby, and J. T. Kent. 1982. <em>Multivariate
Analysis</em>. Probability and Mathematical Statistics. Acad. Press. <a href="https://books.google.com/books?id=1nLonQEACAAJ">https://books.google.com/books?id=1nLonQEACAAJ</a>.
</div>
<div id="ref-rstatsteam" class="csl-entry">
R Core Team. 2017. <em>R: A Language and Environment for Statistical
Computing</em>. Vienna, Austria: R Foundation for Statistical Computing.
<a href="https://www.R-project.org/">https://www.R-project.org/</a>.
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
